{% set views_accordion_items = [] %}

{% set expanded_index = 0 %}
{% if (options.collapse.first is defined and options.collapse.first > 0) %}
  {% set expanded_index = 1 %}
{% endif %}

{% if (options.collapse.last is defined and options.collapse.last > 0) %}
  {% set len = rows|length %}
  {% set expanded_index = len %}
{% endif %}

{% for row in rows %}

  {% set accordion_item_header = row.title %}
  {% set accordion_item_body = row.content %}

  {% set accordion_item = {'header': accordion_item_header, 'body': accordion_item_body } %}
  {% set views_accordion_items = views_accordion_items|merge([accordion_item]) %}

{% endfor %}

{%
  include 'varbase_components:accordion' with {
    accordion_id: id,
    items: views_accordion_items,
    header_tag: 'h4',
    flush: false,
    expanded_item_index: expanded_index,
    utility_classes: classes
  }
%}
